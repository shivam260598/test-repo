{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport Fuse from \"fuse.js\";\nimport { parse } from 'csv-parse';\n\nconst useApp = () => {\n  _s();\n\n  const [response, setResponse] = useState([]);\n  const [inputSearch, setInputSearch] = useState(\"\");\n  const [searchResult, setSearchResult] = useState([]);\n  const [page, setPage] = useState(\"\");\n\n  const getApi = async () => {\n    try {\n      await fetch(\"https://prototype.sbulltech.com/api/v2/instruments\").then(function (response) {\n        return response.text();\n      }).then(function (data) {\n        // const arr = data.split(\"\\n\");\n        // let array = [];\n        // arr.forEach((element, index) => {\n        //   const companyInfo = element.split(\",\");\n        //   if (companyInfo[0] && index !== 0) {\n        //     array = [\n        //       ...array,\n        //       {\n        //         symbol: companyInfo[0],\n        //         name: companyInfo[1],\n        //         sector: companyInfo[2],\n        //         validTill: companyInfo[3],\n        //       },\n        //     ];\n        //   }\n        // });\n        // setResponse(array);\n        console.log('data :: ', data);\n        const records = [];\n        const parser = parse({\n          delimiter: ':'\n        }); // Use the readable stream api to consume records\n\n        parser.on('readable', function () {\n          let record;\n\n          while ((record = parser.read()) !== null) {\n            records.push(record);\n          }\n        });\n      });\n    } catch (error) {\n      console.log(\"error :: \", error);\n    }\n  };\n\n  useEffect(() => {\n    getApi();\n  }, []);\n  useEffect(() => {\n    const fuse = new Fuse(response, {\n      keys: [\"symbol\", \"name\"],\n      shouldSort: true,\n      includeScore: true,\n      threshold: 0.5\n    });\n    const results = fuse.search(inputSearch);\n    setSearchResult(results);\n  }, [inputSearch, response]);\n  return {\n    searchResult,\n    inputSearch,\n    setInputSearch,\n    response,\n    page,\n    setPage\n  };\n};\n\n_s(useApp, \"QRHpss2jqjM5Qyr8JFB68nIQwzg=\");\n\nexport default useApp;","map":{"version":3,"names":["useEffect","useState","Fuse","parse","useApp","response","setResponse","inputSearch","setInputSearch","searchResult","setSearchResult","page","setPage","getApi","fetch","then","text","data","console","log","records","parser","delimiter","on","record","read","push","error","fuse","keys","shouldSort","includeScore","threshold","results","search"],"sources":["/Users/shivamsingh/stocks-application/src/useApp.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport Fuse from \"fuse.js\";\nimport { parse } from 'csv-parse';\n\nconst useApp = () => {\n  const [response, setResponse] = useState([]);\n  const [inputSearch, setInputSearch] = useState(\"\");\n  const [searchResult, setSearchResult] = useState([]);\n  const [page, setPage] = useState(\"\");\n\n  const getApi = async () => {\n    try {\n      await fetch(\"https://prototype.sbulltech.com/api/v2/instruments\")\n        .then(function (response) {\n          return response.text();\n        })\n        .then(function (data) {\n          // const arr = data.split(\"\\n\");\n          // let array = [];\n          // arr.forEach((element, index) => {\n          //   const companyInfo = element.split(\",\");\n          //   if (companyInfo[0] && index !== 0) {\n          //     array = [\n          //       ...array,\n          //       {\n          //         symbol: companyInfo[0],\n          //         name: companyInfo[1],\n          //         sector: companyInfo[2],\n          //         validTill: companyInfo[3],\n          //       },\n          //     ];\n          //   }\n          // });\n\n          // setResponse(array);\n\n          console.log('data :: ', data);\n          const records = [];\n          \n          const parser = parse({\n            delimiter: ':'\n          });\n          // Use the readable stream api to consume records\n          parser.on('readable', function(){\n            let record;\n            while ((record = parser.read()) !== null) {\n              records.push(record);\n            }\n          });\n        });\n    } catch (error) {\n      console.log(\"error :: \", error);\n    }\n  };\n\n  useEffect(() => {\n    getApi();\n  }, []);\n\n  useEffect(() => {\n    const fuse = new Fuse(response, {\n      keys: [\"symbol\", \"name\"],\n      shouldSort: true,\n      includeScore: true,\n      threshold: 0.5,\n    });\n\n    const results = fuse.search(inputSearch);\n    setSearchResult(results);\n  }, [inputSearch, response]);\n\n  return {\n    searchResult,\n    inputSearch,\n    setInputSearch,\n    response,\n    page,\n    setPage,\n  };\n};\n\nexport default useApp;\n"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACA,SAASC,KAAT,QAAsB,WAAtB;;AAEA,MAAMC,MAAM,GAAG,MAAM;EAAA;;EACnB,MAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BL,QAAQ,CAAC,EAAD,CAAxC;EACA,MAAM,CAACM,WAAD,EAAcC,cAAd,IAAgCP,QAAQ,CAAC,EAAD,CAA9C;EACA,MAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCT,QAAQ,CAAC,EAAD,CAAhD;EACA,MAAM,CAACU,IAAD,EAAOC,OAAP,IAAkBX,QAAQ,CAAC,EAAD,CAAhC;;EAEA,MAAMY,MAAM,GAAG,YAAY;IACzB,IAAI;MACF,MAAMC,KAAK,CAAC,oDAAD,CAAL,CACHC,IADG,CACE,UAAUV,QAAV,EAAoB;QACxB,OAAOA,QAAQ,CAACW,IAAT,EAAP;MACD,CAHG,EAIHD,IAJG,CAIE,UAAUE,IAAV,EAAgB;QACpB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QAEA;QAEAC,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,IAAxB;QACA,MAAMG,OAAO,GAAG,EAAhB;QAEA,MAAMC,MAAM,GAAGlB,KAAK,CAAC;UACnBmB,SAAS,EAAE;QADQ,CAAD,CAApB,CAvBoB,CA0BpB;;QACAD,MAAM,CAACE,EAAP,CAAU,UAAV,EAAsB,YAAU;UAC9B,IAAIC,MAAJ;;UACA,OAAO,CAACA,MAAM,GAAGH,MAAM,CAACI,IAAP,EAAV,MAA6B,IAApC,EAA0C;YACxCL,OAAO,CAACM,IAAR,CAAaF,MAAb;UACD;QACF,CALD;MAMD,CArCG,CAAN;IAsCD,CAvCD,CAuCE,OAAOG,KAAP,EAAc;MACdT,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBQ,KAAzB;IACD;EACF,CA3CD;;EA6CA3B,SAAS,CAAC,MAAM;IACda,MAAM;EACP,CAFQ,EAEN,EAFM,CAAT;EAIAb,SAAS,CAAC,MAAM;IACd,MAAM4B,IAAI,GAAG,IAAI1B,IAAJ,CAASG,QAAT,EAAmB;MAC9BwB,IAAI,EAAE,CAAC,QAAD,EAAW,MAAX,CADwB;MAE9BC,UAAU,EAAE,IAFkB;MAG9BC,YAAY,EAAE,IAHgB;MAI9BC,SAAS,EAAE;IAJmB,CAAnB,CAAb;IAOA,MAAMC,OAAO,GAAGL,IAAI,CAACM,MAAL,CAAY3B,WAAZ,CAAhB;IACAG,eAAe,CAACuB,OAAD,CAAf;EACD,CAVQ,EAUN,CAAC1B,WAAD,EAAcF,QAAd,CAVM,CAAT;EAYA,OAAO;IACLI,YADK;IAELF,WAFK;IAGLC,cAHK;IAILH,QAJK;IAKLM,IALK;IAMLC;EANK,CAAP;AAQD,CA3ED;;GAAMR,M;;AA6EN,eAAeA,MAAf"},"metadata":{},"sourceType":"module"}